{{define "title"}}Users Admin{{end}}

{{define "body"}}

<link rel="stylesheet" href="/static/admin.css">

<div class="blurb">
  {{.TotalUsers}} users with {{.TotalRepos}} repositories.
</div>

<table id="users-table">
  <thead>
    <tr>
      <th>User ID</th>
      <th>Username</th>
      <th>Email</th>
      <th>Frequency</th>
      <th>Repositories</th>
      <th>Account</th>
    </tr>
  </thead>
  <tbody>
    {{range .Users}}
      <tr>
        <td><a href="{{routeUrl "digest-admin"}}?user_id={{.Account.GitHubUserId}}">{{.Account.GitHubUserId}}</a></td>
        <td>
          {{if .User}}
            {{template "user" .User}}
          {{else}}
            User could not be looked up, credentials have most likely been revoked.
          {{end}}
        </td>
        <td>{{.EmailAddress}}</td>
        <td>{{.Account.Frequency}}</td>
        <td>
          {{if .ReposError}}
            {{.ReposError}}
          {{else}}
            {{len .Repos.AllRepos}} from {{len .Repos.OtherUserRepos}} other users and {{len .Repos.OrgRepos}} organizations
          {{end}}
        </td>
        <td>
          <form method="POST" action="{{routeUrl "delete-account-admin"}}" onsubmit="return confirm('Really delete?')">
            <input type="hidden" name="user_id" value="{{.Account.GitHubUserId}}">
            <input type="submit" value="Delete">
          </form>
        </td>
      </tr>
    {{end}}
  </tbody>
</table>

{{end}}
